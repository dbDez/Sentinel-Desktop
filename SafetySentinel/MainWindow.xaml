<Window x:Class="SafetySentinel.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:wv2="clr-namespace:Microsoft.Web.WebView2.Wpf;assembly=Microsoft.Web.WebView2.Wpf"
        Title="SENTINEL â€” Personal Threat Intelligence"
        Width="1400" Height="900"
        MinWidth="1000" MinHeight="700"
        WindowStartupLocation="CenterScreen"
        Background="#0a0e17"
        Loaded="Window_Loaded"
        Icon="Assets/sentinel.ico">

    <Window.Resources>
        <!-- Color palette: CIA Operations Center dark theme -->
        <SolidColorBrush x:Key="PrimaryBg" Color="#0a0e17"/>
        <SolidColorBrush x:Key="SecondaryBg" Color="#111827"/>
        <SolidColorBrush x:Key="PanelBg" Color="#1a1f2e"/>
        <SolidColorBrush x:Key="BorderBrush" Color="#1e293b"/>
        <SolidColorBrush x:Key="TextPrimary" Color="#e5e7eb"/>
        <SolidColorBrush x:Key="TextSecondary" Color="#9ca3af"/>
        <SolidColorBrush x:Key="AccentGreenBrush" Color="#00ff88"/>
        <SolidColorBrush x:Key="AccentYellowBrush" Color="#fbbf24"/>
        <SolidColorBrush x:Key="AccentOrangeBrush" Color="#f97316"/>
        <SolidColorBrush x:Key="AccentBrush" Color="#ef4444"/>

        <!-- Default text styles -->
        <Style TargetType="TextBlock">
            <Setter Property="Foreground" Value="{StaticResource TextPrimary}"/>
            <Setter Property="FontFamily" Value="Segoe UI"/>
        </Style>
        <Style TargetType="TextBox">
            <Setter Property="Background" Value="#111827"/>
            <Setter Property="Foreground" Value="#e5e7eb"/>
            <Setter Property="BorderBrush" Value="#1e293b"/>
            <Setter Property="Padding" Value="6,4"/>
            <Setter Property="FontFamily" Value="Segoe UI"/>
        </Style>
        <Style TargetType="Button">
            <Setter Property="Background" Value="#1a1f2e"/>
            <Setter Property="Foreground" Value="#e5e7eb"/>
            <Setter Property="BorderBrush" Value="#1e293b"/>
            <Setter Property="Padding" Value="12,6"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FontFamily" Value="Segoe UI"/>
        </Style>
        <Style TargetType="ComboBox">
            <Setter Property="Background" Value="#111827"/>
            <Setter Property="Foreground" Value="#e5e7eb"/>
            <Setter Property="BorderBrush" Value="#1e293b"/>
            <Setter Property="Padding" Value="6,4"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBox">
                        <Grid>
                            <ToggleButton x:Name="ToggleButton"
                                          Background="#111827" BorderBrush="#1e293b" BorderThickness="1"
                                          Foreground="#e5e7eb"
                                          IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                                          Focusable="False" ClickMode="Press">
                                <ToggleButton.Template>
                                    <ControlTemplate TargetType="ToggleButton">
                                        <Border x:Name="Border" Background="#111827" BorderBrush="#1e293b" BorderThickness="1" CornerRadius="2">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="20"/>
                                                </Grid.ColumnDefinitions>
                                                <Border Grid.Column="0" Background="Transparent"/>
                                                <Path Grid.Column="1" Data="M0,0 L4,4 L8,0" Stroke="#9ca3af" StrokeThickness="1.5"
                                                      HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Grid>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="Border" Property="BorderBrush" Value="#00ff88"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </ToggleButton.Template>
                            </ToggleButton>
                            <ContentPresenter x:Name="ContentSite"
                                              Content="{TemplateBinding SelectionBoxItem}"
                                              ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                              IsHitTestVisible="False"
                                              Margin="8,4,24,4"
                                              VerticalAlignment="Center"
                                              HorizontalAlignment="Left"/>
                            <Popup x:Name="PART_Popup" Placement="Bottom"
                                   IsOpen="{TemplateBinding IsDropDownOpen}"
                                   AllowsTransparency="True" Focusable="False"
                                   PopupAnimation="Slide">
                                <Grid x:Name="DropDown" MinWidth="{TemplateBinding ActualWidth}" MaxHeight="300" SnapsToDevicePixels="True">
                                    <Border x:Name="DropDownBorder" Background="#111827" BorderBrush="#1e293b" BorderThickness="1" CornerRadius="2"/>
                                    <ScrollViewer Margin="2" SnapsToDevicePixels="True">
                                        <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Contained"/>
                                    </ScrollViewer>
                                </Grid>
                            </Popup>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style TargetType="ComboBoxItem">
            <Setter Property="Background" Value="#111827"/>
            <Setter Property="Foreground" Value="#e5e7eb"/>
            <Setter Property="Padding" Value="8,4"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBoxItem">
                        <Border x:Name="Border" Background="#111827" Padding="{TemplateBinding Padding}">
                            <ContentPresenter/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsHighlighted" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#1a1f2e"/>
                                <Setter Property="Foreground" Value="#00ff88"/>
                            </Trigger>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#1a1f2e"/>
                                <Setter Property="Foreground" Value="#00ff88"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style TargetType="CheckBox">
            <Setter Property="Foreground" Value="#e5e7eb"/>
        </Style>
        <Style TargetType="Label">
            <Setter Property="Foreground" Value="#9ca3af"/>
            <Setter Property="FontFamily" Value="Segoe UI"/>
        </Style>
        <Style TargetType="TabControl">
            <Setter Property="Background" Value="#0a0e17"/>
            <Setter Property="BorderBrush" Value="#1e293b"/>
            <Setter Property="Foreground" Value="#e5e7eb"/>
        </Style>
        <Style TargetType="TabItem">
            <Setter Property="Background" Value="#111827"/>
            <Setter Property="Foreground" Value="#9ca3af"/>
            <Setter Property="BorderBrush" Value="#1e293b"/>
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="Padding" Value="10,4"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabItem">
                        <Border x:Name="TabBorder" Background="#111827" BorderBrush="#1e293b"
                                BorderThickness="1,1,1,0" CornerRadius="4,4,0,0"
                                Padding="12,6" Margin="1,0">
                            <ContentPresenter x:Name="ContentSite"
                                              ContentSource="Header"
                                              HorizontalAlignment="Center"
                                              VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="TabBorder" Property="Background" Value="#1a1f2e"/>
                                <Setter TargetName="TabBorder" Property="BorderBrush" Value="#00ff88"/>
                                <Setter Property="Foreground" Value="#00ff88"/>
                            </Trigger>
                            <Trigger Property="IsSelected" Value="False">
                                <Setter TargetName="TabBorder" Property="Background" Value="#111827"/>
                                <Setter Property="Foreground" Value="#9ca3af"/>
                            </Trigger>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsMouseOver" Value="True"/>
                                    <Condition Property="IsSelected" Value="False"/>
                                </MultiTrigger.Conditions>
                                <Setter TargetName="TabBorder" Property="Background" Value="#1a1f2e"/>
                                <Setter Property="Foreground" Value="#e5e7eb"/>
                            </MultiTrigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="60"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="28"/>
        </Grid.RowDefinitions>

        <!-- ============ HEADER BAR ============ -->
        <Border Grid.Row="0" Background="#111827" BorderBrush="#1e293b" BorderThickness="0,0,0,1">
            <Grid Margin="16,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Logo -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,20,0">
                    <Image Source="Assets/Sentinel.png" Width="40" Height="40" Margin="0,0,10,0"
                           RenderOptions.BitmapScalingMode="HighQuality"/>
                    <TextBlock Text="SENTINEL" FontSize="20" FontWeight="Bold"
                               Foreground="#00ff88" VerticalAlignment="Center"
                               FontFamily="Consolas"/>
                </StackPanel>

                <!-- Threat Level Badge -->
                <Border x:Name="ThreatLevelBadge" Grid.Column="1" CornerRadius="4" Padding="10,4"
                        Background="{StaticResource AccentYellowBrush}" VerticalAlignment="Center" Margin="0,0,16,0">
                    <TextBlock x:Name="ThreatLevelText" Text="YELLOW" FontWeight="Bold"
                               Foreground="#0a0e17" FontSize="13" FontFamily="Consolas"/>
                </Border>

                <!-- Hijack Risk Badge -->
                <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,16,0">
                    <TextBlock Text="HIJACK: " Foreground="#9ca3af" FontSize="11" VerticalAlignment="Center"/>
                    <Border x:Name="HijackRiskBadge" CornerRadius="4" Padding="8,3"
                            Background="{StaticResource AccentYellowBrush}">
                        <TextBlock x:Name="HijackRiskText" Text="MODERATE (45)" FontWeight="SemiBold"
                                   Foreground="#0a0e17" FontSize="11" FontFamily="Consolas"/>
                    </Border>
                </StackPanel>

                <!-- Country count -->
                <TextBlock x:Name="CountryCount" Grid.Column="3" Text="54 countries monitored"
                           Foreground="#9ca3af" FontSize="11" VerticalAlignment="Center"/>

                <!-- Scan Now button -->
                <Button Grid.Column="4" Content="ðŸ” Scan Now" Click="ScanNow_Click"
                        Background="#1a3a2a" Foreground="#00ff88" BorderBrush="#00ff88"
                        FontWeight="SemiBold" Margin="0,0,16,0" VerticalAlignment="Center"/>

                <!-- Clock -->
                <TextBlock x:Name="HeaderTime" Grid.Column="5" Text="00:00:00"
                           Foreground="#00ff88" FontSize="13" VerticalAlignment="Center"
                           FontFamily="Consolas"/>
            </Grid>
        </Border>

        <!-- ============ MAIN CONTENT â€” TAB CONTROL ============ -->
        <TabControl Grid.Row="1" Background="#0a0e17" BorderBrush="#1e293b"
                    Padding="0" Margin="0">

            <!-- ===== GLOBE TAB ===== -->
            <TabItem Header="ðŸŒ Globe">
                <Grid Background="#0a0e17">
                    <wv2:WebView2 x:Name="GlobeWebView" DefaultBackgroundColor="#0a0e17"/>
                    <!-- Logo overlay top-right -->
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Top" HorizontalAlignment="Right"
                                Margin="0,12,16,0" IsHitTestVisible="False">
                        <Border Background="#111827" CornerRadius="8" Padding="8,6" Opacity="0.92"
                                BorderBrush="#1e293b" BorderThickness="1">
                            <StackPanel Orientation="Horizontal">
                                <Image Source="Assets/Sentinel.png" Width="32" Height="32" Margin="0,0,8,0"
                                       RenderOptions.BitmapScalingMode="HighQuality"/>
                                <StackPanel VerticalAlignment="Center">
                                    <TextBlock Text="SENTINEL" FontSize="14" FontWeight="Bold"
                                               Foreground="#00ff88" FontFamily="Consolas"/>
                                    <TextBlock Text="Global Threat Monitor" FontSize="9"
                                               Foreground="#9ca3af" FontFamily="Consolas"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </Grid>
            </TabItem>

            <!-- ===== BRIEF TAB ===== -->
            <TabItem Header="ðŸ“‹ Brief">
                <Grid Background="#0a0e17" Margin="16">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                        <Image Source="Assets/Sentinel.png" Width="28" Height="28" Margin="0,0,10,0"
                               RenderOptions.BitmapScalingMode="HighQuality" VerticalAlignment="Center"/>
                        <TextBlock Text="DAILY INTELLIGENCE BRIEF" FontSize="16" FontWeight="Bold"
                                   Foreground="#00ff88" FontFamily="Consolas" VerticalAlignment="Center"/>
                        <TextBlock x:Name="BriefDateText" Text="" Foreground="#9ca3af"
                                   FontSize="12" VerticalAlignment="Center" Margin="20,0,0,0"/>
                    </StackPanel>

                    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                        <TextBlock x:Name="BriefContent" TextWrapping="Wrap" FontFamily="Consolas"
                                   FontSize="12" Foreground="#e5e7eb" Padding="12"
                                   Background="#111827"
                                   Text="No intelligence brief generated yet.&#10;&#10;1. Fill in your Profile&#10;2. Add your Claude API key in Settings&#10;3. Click ðŸ” Scan Now"/>
                    </ScrollViewer>
                </Grid>
            </TabItem>

            <!-- ===== HISTORY TAB ===== -->
            <TabItem Header="ðŸ“œ History">
                <Grid Background="#0a0e17" Margin="16">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="280"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <Border Grid.Column="0" Background="#111827" CornerRadius="4" Margin="0,0,8,0" Padding="8">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                <Image Source="Assets/Sentinel.png" Width="20" Height="20" Margin="0,0,6,0"
                                       RenderOptions.BitmapScalingMode="HighQuality" VerticalAlignment="Center"/>
                                <TextBlock Text="BRIEF HISTORY" FontWeight="Bold" Foreground="#00ff88"
                                           FontFamily="Consolas" VerticalAlignment="Center"/>
                            </StackPanel>
                            <ListBox x:Name="BriefHistoryList" Grid.Row="1"
                                     Background="#111827" Foreground="#e5e7eb" BorderThickness="0"
                                     SelectionChanged="BriefHistory_SelectionChanged"
                                     DisplayMemberPath="DisplayText"/>
                        </Grid>
                    </Border>

                    <ScrollViewer Grid.Column="1" VerticalScrollBarVisibility="Auto">
                        <TextBlock x:Name="HistoryBriefContent" TextWrapping="Wrap" FontFamily="Consolas"
                                   FontSize="12" Foreground="#e5e7eb" Padding="12" Background="#111827"
                                   Text="Select a brief from the list to view."/>
                    </ScrollViewer>
                </Grid>
            </TabItem>

            <!-- ===== ALERTS TAB ===== -->
            <TabItem Header="ðŸ”” Alerts">
                <Grid Background="#0a0e17" Margin="16">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                        <Image Source="Assets/Sentinel.png" Width="28" Height="28" Margin="0,0,10,0"
                               RenderOptions.BitmapScalingMode="HighQuality" VerticalAlignment="Center"/>
                        <TextBlock Text="ALERT CATEGORIES" FontSize="16" FontWeight="Bold"
                                   Foreground="#00ff88" FontFamily="Consolas" VerticalAlignment="Center"/>
                        <TextBlock x:Name="AlertCountText" Text="" Foreground="#9ca3af"
                                   FontSize="12" VerticalAlignment="Center" Margin="20,0,0,0"/>
                    </StackPanel>

                    <ListView x:Name="AlertCategoriesList" Grid.Row="1"
                              Background="#0a0e17" BorderThickness="0" Foreground="#e5e7eb">
                        <ListView.ItemTemplate>
                            <DataTemplate>
                                <Grid Margin="0,2">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="30"/>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="200"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="60"/>
                                        <ColumnDefinition Width="80"/>
                                    </Grid.ColumnDefinitions>
                                    <CheckBox Grid.Column="0" IsChecked="{Binding Enabled}"
                                              Click="AlertToggle_Click" VerticalAlignment="Center"/>
                                    <TextBlock Grid.Column="1" Text="{Binding Domain}" Foreground="#fbbf24"
                                               FontWeight="SemiBold" FontSize="11" VerticalAlignment="Center"/>
                                    <TextBlock Grid.Column="2" Text="{Binding Category}" Foreground="#e5e7eb"
                                               FontWeight="SemiBold" VerticalAlignment="Center"/>
                                    <TextBlock Grid.Column="3" Text="{Binding Description}" Foreground="#9ca3af"
                                               FontSize="11" VerticalAlignment="Center" TextTrimming="CharacterEllipsis"/>
                                    <TextBlock Grid.Column="4" Text="{Binding SeverityWeight}" Foreground="#f97316"
                                               FontWeight="Bold" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                    <TextBlock Grid.Column="5" Text="{Binding ScanFrequency}" Foreground="#9ca3af"
                                               FontSize="10" VerticalAlignment="Center"/>
                                </Grid>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </Grid>
            </TabItem>

            <!-- ===== WATCHLIST TAB ===== -->
            <TabItem Header="ðŸ‘ Watchlist">
                <Grid Background="#0a0e17" Margin="16">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                        <Image Source="Assets/Sentinel.png" Width="28" Height="28" Margin="0,0,10,0"
                               RenderOptions.BitmapScalingMode="HighQuality" VerticalAlignment="Center"/>
                        <TextBlock Text="COUNTRY WATCHLIST" FontSize="16" FontWeight="Bold"
                                   Foreground="#00ff88" FontFamily="Consolas" VerticalAlignment="Center"/>
                    </StackPanel>

                    <!-- Add watchlist -->
                    <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,10">
                        <TextBox x:Name="WatchCountryCode" Width="60" Margin="0,0,8,0"/>
                        <TextBox x:Name="WatchReason" Width="300" Margin="0,0,8,0"/>
                        <Button Content="+ Add" Click="AddWatchlist_Click" Background="#1a3a2a"
                                Foreground="#00ff88" BorderBrush="#00ff88"/>
                        <Button Content="Remove" Click="RemoveWatchlist_Click" Margin="8,0,0,0"
                                Background="#3a1a1a" Foreground="#ef4444" BorderBrush="#ef4444"/>
                    </StackPanel>

                    <ListBox x:Name="WatchlistView" Grid.Row="2" Background="#111827"
                             Foreground="#e5e7eb" BorderThickness="0" Margin="0,0,0,16"
                             DisplayMemberPath="CountryName"/>

                    <TextBlock Grid.Row="3" Text="AVOIDANCE ZONES" FontSize="14" FontWeight="Bold"
                               Foreground="#fbbf24" FontFamily="Consolas" Margin="0,0,0,8"/>
                    <ListBox x:Name="AvoidanceView" Grid.Row="4" Background="#111827"
                             Foreground="#e5e7eb" BorderThickness="0"
                             DisplayMemberPath="Name"/>
                </Grid>
            </TabItem>

            <!-- ===== EXIT PLANS TAB ===== -->
            <TabItem Header="ðŸšª Exit Plans">
                <Grid Background="#0a0e17" Margin="16">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                        <Image Source="Assets/Sentinel.png" Width="28" Height="28" Margin="0,0,10,0"
                               RenderOptions.BitmapScalingMode="HighQuality" VerticalAlignment="Center"/>
                        <TextBlock Text="EXIT PLANS" FontSize="16" FontWeight="Bold"
                                   Foreground="#00ff88" FontFamily="Consolas" Margin="0,0,16,0"
                                   VerticalAlignment="Center"/>
                        <ComboBox x:Name="ExitPlanSelector" Width="250"
                                  SelectionChanged="ExitPlanSelector_Changed">
                            <ComboBoxItem Content="Plan A: USA (Primary)" IsSelected="True"/>
                            <ComboBoxItem Content="Plan B: Portugal (Backup)"/>
                            <ComboBoxItem Content="Plan C: Emergency Evacuation"/>
                        </ComboBox>
                        <TextBlock x:Name="ExitPlanProgress" Text="" Foreground="#fbbf24"
                                   VerticalAlignment="Center" Margin="16,0,0,0" FontWeight="SemiBold"/>
                        <Button Content="ðŸ“‹ Copy Plan" Click="CopyExitPlan_Click" Margin="16,0,0,0"/>
                    </StackPanel>

                    <ListView x:Name="ExitPlanList" Grid.Row="2"
                              Background="#0a0e17" BorderThickness="0" Foreground="#e5e7eb">
                        <ListView.ItemTemplate>
                            <DataTemplate>
                                <Grid Margin="0,3">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="30"/>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="200"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <CheckBox Grid.Column="0" IsChecked="{Binding Completed}"
                                              Click="ExitPlanCheck_Click" VerticalAlignment="Center"/>
                                    <TextBlock Grid.Column="1" Text="{Binding Category}" Foreground="#fbbf24"
                                               FontWeight="SemiBold" FontSize="11" VerticalAlignment="Center"/>
                                    <TextBlock Grid.Column="2" Text="{Binding TaskTitle}" Foreground="#e5e7eb"
                                               FontWeight="SemiBold" VerticalAlignment="Center"/>
                                    <TextBlock Grid.Column="3" Text="{Binding TaskDescription}" Foreground="#9ca3af"
                                               FontSize="11" VerticalAlignment="Center" TextTrimming="CharacterEllipsis"/>
                                </Grid>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </Grid>
            </TabItem>

            <!-- ===== PROFILE TAB ===== -->
            <TabItem Header="ðŸ‘¤ Profile">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Background="#0a0e17">
                    <StackPanel Margin="16">
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <Image Source="Assets/Sentinel.png" Width="28" Height="28" Margin="0,0,10,0"
                                   RenderOptions.BitmapScalingMode="HighQuality" VerticalAlignment="Center"/>
                            <TextBlock Text="HVR PROFILE" FontSize="16" FontWeight="Bold"
                                       Foreground="#00ff88" FontFamily="Consolas" VerticalAlignment="Center"/>
                        </StackPanel>

                        <!-- Personal Info -->
                        <TextBlock Text="PERSONAL INFORMATION" Foreground="#fbbf24" FontWeight="Bold" Margin="0,0,0,8"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="300"/>
                                <ColumnDefinition Width="40"/>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="300"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="36"/>
                                <RowDefinition Height="36"/>
                                <RowDefinition Height="36"/>
                                <RowDefinition Height="36"/>
                                <RowDefinition Height="36"/>
                                <RowDefinition Height="36"/>
                                <RowDefinition Height="36"/>
                                <RowDefinition Height="36"/>
                            </Grid.RowDefinitions>

                            <Label Content="Full Name" Grid.Row="0" Grid.Column="0"/>
                            <TextBox x:Name="ProfileName" Grid.Row="0" Grid.Column="1"/>
                            <Label Content="ID Number" Grid.Row="0" Grid.Column="3"/>
                            <TextBox x:Name="ProfileIdNumber" Grid.Row="0" Grid.Column="4"/>

                            <Label Content="Age" Grid.Row="1" Grid.Column="0"/>
                            <TextBox x:Name="ProfileAge" Grid.Row="1" Grid.Column="1" Width="80" HorizontalAlignment="Left"/>
                            <Label Content="Gender" Grid.Row="1" Grid.Column="3"/>
                            <ComboBox x:Name="ProfileGender" Grid.Row="1" Grid.Column="4" Width="120" HorizontalAlignment="Left">
                                <ComboBoxItem Content="Male"/>
                                <ComboBoxItem Content="Female"/>
                                <ComboBoxItem Content="Other"/>
                            </ComboBox>

                            <Label Content="Ethnicity" Grid.Row="2" Grid.Column="0"/>
                            <TextBox x:Name="ProfileEthnicity" Grid.Row="2" Grid.Column="1"/>
                            <Label Content="Immigration" Grid.Row="2" Grid.Column="3"/>
                            <TextBox x:Name="ProfileImmigration" Grid.Row="2" Grid.Column="4"/>

                            <Label Content="Country (Code)" Grid.Row="3" Grid.Column="0"/>
                            <TextBox x:Name="ProfileCountry" Grid.Row="3" Grid.Column="1" Width="80" HorizontalAlignment="Left"/>
                            <Label Content="City" Grid.Row="3" Grid.Column="3"/>
                            <TextBox x:Name="ProfileCity" Grid.Row="3" Grid.Column="4"/>

                            <Label Content="Latitude" Grid.Row="4" Grid.Column="0"/>
                            <TextBox x:Name="ProfileLat" Grid.Row="4" Grid.Column="1" Width="150" HorizontalAlignment="Left"/>
                            <Label Content="Longitude" Grid.Row="4" Grid.Column="3"/>
                            <TextBox x:Name="ProfileLon" Grid.Row="4" Grid.Column="4" Width="150" HorizontalAlignment="Left"/>

                            <Label Content="Dest. Country" Grid.Row="5" Grid.Column="0"/>
                            <TextBox x:Name="ProfileDestCountry" Grid.Row="5" Grid.Column="1" Width="80" HorizontalAlignment="Left"/>
                            <Label Content="Dest. City" Grid.Row="5" Grid.Column="3"/>
                            <TextBox x:Name="ProfileDestCity" Grid.Row="5" Grid.Column="4"/>

                            <Label Content="Vehicle Type" Grid.Row="6" Grid.Column="0"/>
                            <ComboBox x:Name="ProfileVehicleType" Grid.Row="6" Grid.Column="1" Width="120" HorizontalAlignment="Left">
                                <ComboBoxItem Content="Sedan"/>
                                <ComboBoxItem Content="SUV"/>
                                <ComboBoxItem Content="Hatchback"/>
                                <ComboBoxItem Content="Bakkie"/>
                                <ComboBoxItem Content="Luxury"/>
                                <ComboBoxItem Content="4x4"/>
                            </ComboBox>
                            <Label Content="Make / Model" Grid.Row="6" Grid.Column="3"/>
                            <TextBox x:Name="ProfileVehicleMakeModel" Grid.Row="6" Grid.Column="4"/>
                        </Grid>

                        <!-- Values, Health, Skills -->
                        <TextBlock Text="VALUES &amp; LIFESTYLE" Foreground="#fbbf24" FontWeight="Bold" Margin="0,16,0,8"/>
                        <Label Content="Core Values"/>
                        <TextBox x:Name="ProfileValues" TextWrapping="Wrap" AcceptsReturn="True" Height="50"/>
                        <Label Content="Health Approach"/>
                        <TextBox x:Name="ProfileHealth" TextWrapping="Wrap" Height="30"/>
                        <Label Content="Skills"/>
                        <TextBox x:Name="ProfileSkills" TextWrapping="Wrap" AcceptsReturn="True" Height="50"/>

                        <Button Content="ðŸ’¾ Save Profile" Click="SaveProfile_Click" Margin="0,16,0,0"
                                Background="#1a3a2a" Foreground="#00ff88" BorderBrush="#00ff88"
                                FontWeight="Bold" HorizontalAlignment="Left" Padding="20,8"/>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- ===== SETTINGS TAB ===== -->
            <TabItem Header="âš™ Settings">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Background="#0a0e17">
                    <StackPanel Margin="16" MaxWidth="700" HorizontalAlignment="Left">
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <Image Source="Assets/Sentinel.png" Width="28" Height="28" Margin="0,0,10,0"
                                   RenderOptions.BitmapScalingMode="HighQuality" VerticalAlignment="Center"/>
                            <TextBlock Text="SETTINGS" FontSize="16" FontWeight="Bold"
                                       Foreground="#00ff88" FontFamily="Consolas" VerticalAlignment="Center"/>
                        </StackPanel>

                        <!-- API Configuration -->
                        <TextBlock Text="API CONFIGURATION" Foreground="#fbbf24" FontWeight="Bold" Margin="0,0,0,8"/>
                        <Label Content="Claude API Key"/>
                        <PasswordBox x:Name="SettingsApiKey" Background="#111827" Foreground="#e5e7eb"
                                     BorderBrush="#1e293b" Padding="6,4"/>
                        <Label Content="Claude Model"/>
                        <ComboBox x:Name="SettingsModel" Width="300" HorizontalAlignment="Left">
                            <ComboBoxItem Content="claude-sonnet-4-20250514"/>
                            <ComboBoxItem Content="claude-opus-4-20250514"/>
                            <ComboBoxItem Content="claude-haiku-3-5-20241022"/>
                        </ComboBox>
                        <Label Content="Google Maps API Key"/>
                        <TextBox x:Name="SettingsGoogleKey"/>

                        <!-- Scan Configuration -->
                        <TextBlock Text="SCAN CONFIGURATION" Foreground="#fbbf24" FontWeight="Bold" Margin="0,16,0,8"/>
                        <StackPanel Orientation="Horizontal">
                            <Label Content="Scan Interval (hours)"/>
                            <TextBox x:Name="SettingsScanInterval" Width="60" Text="2"/>
                            <Label Content="Daily Brief Time" Margin="16,0,0,0"/>
                            <TextBox x:Name="SettingsBriefTime" Width="80" Text="08:00"/>
                        </StackPanel>
                        <CheckBox x:Name="SettingsAutoStart" Content="Auto-start scheduler on launch"
                                  Margin="0,8,0,0"/>

                        <!-- Scheduler status -->
                        <TextBlock x:Name="SchedulerStatus" Text="" Foreground="#9ca3af"
                                   FontSize="11" Margin="0,8,0,0"/>

                        <Button Content="ðŸ’¾ Save Settings" Click="SaveSettings_Click" Margin="0,16,0,0"
                                Background="#1a3a2a" Foreground="#00ff88" BorderBrush="#00ff88"
                                FontWeight="Bold" HorizontalAlignment="Left" Padding="20,8"/>

                        <!-- Data Management -->
                        <TextBlock Text="DATA MANAGEMENT" Foreground="#fbbf24" FontWeight="Bold" Margin="0,24,0,8"/>
                        <StackPanel Orientation="Horizontal">
                            <Button Content="ðŸ“¤ Export JSON" Click="ExportJson_Click" Margin="0,0,8,0"/>
                            <Button Content="ðŸ“± Export Mobile" Click="ExportMobile_Click" Margin="0,0,8,0"/>
                            <Button Content="ðŸ“¥ Import" Click="ImportSentinel_Click"/>
                        </StackPanel>

                        <TextBlock x:Name="SettingsDbPath" Text="" Foreground="#9ca3af"
                                   FontSize="10" Margin="0,16,0,0"/>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
        </TabControl>

        <!-- ============ STATUS BAR ============ -->
        <Border Grid.Row="2" Background="#111827" BorderBrush="#1e293b" BorderThickness="0,1,0,0">
            <Grid Margin="12,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Image Grid.Column="0" Source="Assets/Sentinel.png" Width="18" Height="18" Margin="0,0,8,0"
                       RenderOptions.BitmapScalingMode="HighQuality" VerticalAlignment="Center"/>
                <TextBlock Grid.Column="1" x:Name="StatusText" Text="Loading..." Foreground="#9ca3af"
                           FontSize="11" VerticalAlignment="Center" FontFamily="Consolas"/>
            </Grid>
        </Border>
    </Grid>
</Window>
